
'''
af-ZA	南非荷兰语（南非）	af-ZA-AdriNeural3（女）
af-ZA-WillemNeural3（男）
am-ET	阿姆哈拉语（埃塞俄比亚）	am-ET-MekdesNeural3（女）
am-ET-AmehaNeural3（男）
ar-AE	阿拉伯语（阿拉伯联合酋长国）	ar-AE-FatimaNeural（女）
ar-AE-HamdanNeural（男）
ar-BH	阿拉伯语（巴林）	ar-BH-LailaNeural（女）
ar-BH-AliNeural（男）
ar-DZ	阿拉伯语（阿尔及利亚）	ar-DZ-AminaNeural（女）
ar-DZ-IsmaelNeural（男）
ar-EG	阿拉伯语（埃及）	ar-EG-SalmaNeural（女）
ar-EG-ShakirNeural（男）
ar-IQ	阿拉伯语（伊拉克）	ar-IQ-RanaNeural（女）
ar-IQ-BasselNeural（男）
ar-JO	阿拉伯语（约旦）	ar-JO-SanaNeural（女）
ar-JO-TaimNeural（男）
ar-KW	阿拉伯语（科威特）	ar-KW-NouraNeural（女）
ar-KW-FahedNeural（男）
ar-LB	阿拉伯语（黎巴嫩）	ar-LB-LaylaNeural（女）
ar-LB-RamiNeural（男）
ar-LY	阿拉伯语（利比亚）	ar-LY-ImanNeural（女）
ar-LY-OmarNeural（男）
ar-MA	阿拉伯语（摩洛哥）	ar-MA-MounaNeural（女）
ar-MA-JamalNeural（男）
ar-OM	阿拉伯语（阿曼）	ar-OM-AyshaNeural（女）
ar-OM-AbdullahNeural（男）
ar-QA	阿拉伯语（卡塔尔）	ar-QA-AmalNeural（女）
ar-QA-MoazNeural（男）
ar-SA	阿拉伯语(沙特阿拉伯)	ar-SA-ZariyahNeural（女）
ar-SA-HamedNeural（男）
ar-SY	阿拉伯语（叙利亚）	ar-SY-AmanyNeural（女）
ar-SY-LaithNeural（男）
ar-TN	阿拉伯语（突尼斯）	ar-TN-ReemNeural（女）
ar-TN-HediNeural（男）
ar-YE	阿拉伯语（也门）	ar-YE-MaryamNeural（女）
ar-YE-SalehNeural（男）
as-IN	阿萨姆语（印度）	as-IN-YashicaNeural3（女）
as-IN-PriyomNeural3（男）
az-AZ	阿塞拜疆语(拉丁语，阿塞拜疆)	az-AZ-BanuNeural3（女）
az-AZ-BabekNeural3（男）
bg-BG	保加利亚语(保加利亚)	bg-BG-KalinaNeural（女）
bg-BG-BorislavNeural（男）
bn-BD	孟加拉语（孟加拉国）	bn-BD-NabanitaNeural3（女）
bn-BD-PradeepNeural3（男）
bn-IN	孟加拉语（印度）	bn-IN-TanishaaNeural3（女）
bn-IN-BashkarNeural3（男）
bs-BA	波斯尼亚语（波斯尼亚和黑塞哥维那）	bs-BA-VesnaNeural3（女）
bs-BA-GoranNeural3（男）
ca-ES	加泰罗尼亚语	ca-ES-JoanaNeural（女）
ca-ES-EnricNeural（男）
ca-ES-AlbaNeural（女）
cs-CZ	捷克语(捷克)	cs-CZ-VlastaNeural（女）
cs-CZ-AntoninNeural（男）
cy-GB	威尔士语（英国）	cy-GB-NiaNeural3（女）
cy-GB-AledNeural3（男）
da-DK	丹麦语（丹麦）	da-DK-ChristelNeural（女）
da-DK-JeppeNeural（男）
de-AT	德语（奥地利）	de-AT-IngridNeural（女）
de-AT-JonasNeural（男）
de-CH	德语（瑞士）	de-CH-LeniNeural（女）
de-CH-JanNeural（男）
de-DE	德语（德国）	de-DE-KatjaNeural（女）
de-DE-ConradNeural（男）
de-DE-SeraphinaMultilingualNeural4（女）
de-DE-FlorianMultilingualNeural4（男）
de-DE-AmalaNeural（女）
de-DE-BerndNeural（男）
de-DE-ChristophNeural（男）
de-DE-ElkeNeural（女）
de-DE-GiselaNeural（女性、儿童）
de-DE-KasperNeural（男）
de-DE-KillianNeural（男）
de-DE-KlarissaNeural（女）
de-DE-KlausNeural（男）
de-DE-LouisaNeural（女）
de-DE-MajaNeural（女）
de-DE-RalfNeural（男）
de-DE-TanjaNeural（女）
de-DE-Seraphina:DragonHDLatestNeural1（女）
el-GR	希腊语(希腊)	el-GR-AthinaNeural（女）
el-GR-NestorasNeural（男）
en-AU	英语（澳大利亚）	en-AU-NatashaNeural（女）
en-AU-WilliamNeural（男）
en-AU-AnnetteNeural（女）
en-AU-CarlyNeural（女）
en-AU-DarrenNeural（男）
en-AU-DuncanNeural（男）
en-AU-ElsieNeural（女）
en-AU-FreyaNeural（女）
en-AU-JoanneNeural（女）
en-AU-KenNeural（男）
en-AU-KimNeural（女）
en-AU-NeilNeural（男）
en-AU-TimNeural（男）
en-AU-TinaNeural（女）
en-CA	英语（加拿大）	en-CA-ClaraNeural（女）
en-CA-LiamNeural（男）
en-GB	英语（英国）	en-GB-SoniaNeural（女）
en-GB-RyanNeural（男）
en-GB-LibbyNeural（女）
en-GB-AdaMultilingualNeural4（女）
en-GB-OllieMultilingualNeural4（男）
en-GB-AbbiNeural（女）
en-GB-AlfieNeural（男）
en-GB-BellaNeural（女）
en-GB-ElliotNeural（男）
en-GB-EthanNeural（男）
en-GB-HollieNeural（女）
en-GB-MaisieNeural（女性、儿童）
en-GB-NoahNeural（男）
en-GB-OliverNeural（男）
en-GB-OliviaNeural（女）
en-GB-ThomasNeural（男）
en-HK	英语（香港特別行政区）	en-HK-YanNeural（女）
en-HK-SamNeural（男）
en-IE	英语（爱尔兰）	en-IE-EmilyNeural（女）
en-IE-ConnorNeural（男）
en-IN	英语（印度）	en-IN-AaravNeural（男）
en-IN-AashiNeural（女）
en-IN-AnanyaNeural（女）
en-IN-KavyaNeural（女）
en-IN-KunalNeural（男）
en-IN-NeerjaNeural（女）
en-IN-PrabhatNeural（男）
en-IN-RehaanNeural（男）
en-IN-AartiNeural1（女）
en-IN-ArjunNeural1（男）
en-KE	英语（肯尼亚）	en-KE-AsiliaNeural（女）
en-KE-ChilembaNeural（男）
en-NG	英语（尼日利亚）	en-NG-EzinneNeural（女）
en-NG-AbeoNeural（男）
en-NZ	英语（新西兰）	en-NZ-MollyNeural（女）
en-NZ-MitchellNeural（男）
en-PH	英语（菲律宾）	en-PH-RosaNeural（女）
en-PH-JamesNeural（男）
en-SG	英语（新加坡）	en-SG-LunaNeural（女）
en-SG-WayneNeural（男）
en-TZ	英语（坦桑尼亚）	en-TZ-ImaniNeural（女）
en-TZ-ElimuNeural（男）
en-US	英语（美国）	en-US-AvaMultilingualNeural4（女）
en-US-AndrewMultilingualNeural4（男）
en-US-EmmaMultilingualNeural4（女）
en-US-BrianMultilingualNeural4（男）
en-US-AvaNeural（女）
en-US-AndrewNeural（男）
en-US-EmmaNeural（女）
en-US-BrianNeural（男）
en-US-JennyNeural（女）
en-US-GuyNeural（男）
en-US-AriaNeural（女）
en-US-DavisNeural（男）
en-US-JaneNeural（女）
en-US-JasonNeural（男）
en-US-KaiNeural（男）
en-US-LunaNeural（女）
en-US-SaraNeural（女）
en-US-TonyNeural（男）
en-US-NancyNeural（女）
en-US-CoraMultilingualNeural4（女）
en-US-ChristopherMultilingualNeural4（男）
en-US-BrandonMultilingualNeural4（男）
en-US-AmberNeural（女）
en-US-AnaNeural（女性、儿童）
en-US-AshleyNeural（女）
en-US-BrandonNeural（男）
en-US-ChristopherNeural（男）
en-US-CoraNeural（女）
en-US-ElizabethNeural（女）
en-US-EricNeural（男）
en-US-JacobNeural（男）
en-US-JennyMultilingualNeural4（女）
en-US-MichelleNeural（女）
en-US-MonicaNeural（女）
en-US-RogerNeural（男）
en-US-RyanMultilingualNeural4（男）
en-US-SteffanNeural（男）
en-US-AdamMultilingualNeural1,4（男）
en-US-AIGenerate1Neural1（男）
en-US-AIGenerate2Neural1（女）
en-US-AlloyTurboMultilingualNeural1,4（男）
en-US-AmandaMultilingualNeural1,4（女）
en-US-BlueNeural1（中性）
en-US-DavisMultilingualNeural1,4（男）
en-US-DerekMultilingualNeural1,4（男）
en-US-DustinMultilingualNeural1,4（男）
en-US-EchoTurboMultilingualNeural1,4（男）
en-US-EvelynMultilingualNeural1,4（女）
en-US-FableTurboMultilingualNeural1，4（中性）
en-US-LewisMultilingualNeural1,4（男）
en-US-LolaMultilingualNeural1,4（女）
en-US-NancyMultilingualNeural1,4（女）
en-US-NovaTurboMultilingualNeural1,4（女）
en-US-OnyxTurboMultilingualNeural1,4（男）
en-US-PhoebeMultilingualNeural1,4（女）
en-US-SamuelMultilingualNeural1,4（男）
en-US-SerenaMultilingualNeural1,4（女）
en-US-ShimmerTurboMultilingualNeural1,4（女）
en-US-SteffanMultilingualNeural1,4（男）
en-US-Andrew:DragonHDLatestNeural1（男）
en-US-Andrew2:DragonHDLatestNeural1（男）
en-US-Aria:DragonHDLatestNeural1（女）
en-US-Ava:DragonHDLatestNeural1（女）
en-US-Brian:DragonHDLatestNeural1（男）
en-US-Davis:DragonHDLatestNeural1（男）
en-US-Emma:DragonHDLatestNeural1（女）
en-US-Emma2:DragonHDLatestNeural1（女）
en-US-Jenny:DragonHDLatestNeural1（女）
en-US-Steffan:DragonHDLatestNeural1（男）
en-ZA	英语（南非）	en-ZA-LeahNeural（女）
en-ZA-LukeNeural（男）
es-AR	西班牙语（阿根廷）	es-AR-ElenaNeural（女）
es-AR-TomasNeural（男）
es-BO	西班牙语（玻利维亚）	es-BO-SofiaNeural（女）
es-BO-MarceloNeural（男）
es-CL	西班牙语（智利）	es-CL-CatalinaNeural（女）
es-CL-LorenzoNeural（男）
es-CO	西班牙语（哥伦比亚）	es-CO-SalomeNeural（女）
es-CO-GonzaloNeural（男）
es-CR	西班牙语（哥斯达黎加）	es-CR-MariaNeural（女）
es-CR-JuanNeural（男）
es-CU	西班牙语（古巴）	es-CU-BelkysNeural（女）
es-CU-ManuelNeural（男）
es-DO	西班牙语（多米尼加共和国）	es-DO-RamonaNeural（女）
es-DO-EmilioNeural（男）
es-EC	西班牙语（厄瓜多尔）	es-EC-AndreaNeural（女）
es-EC-LuisNeural（男）
es-ES	西班牙语(西班牙)	es-ES-ElviraNeural（女）
es-ES-AlvaroNeural（男）
es-ES-ArabellaMultilingualNeural4（女）
es-ES-IsidoraMultilingualNeural4（女）
es-ES-TristanMultilingualNeural4（男）
es-ES-XimenaMultilingualNeural4（女）
es-ES-AbrilNeural（女）
es-ES-ArnauNeural（男）
es-ES-DarioNeural（男）
es-ES-EliasNeural（男）
es-ES-EstrellaNeural（女）
es-ES-IreneNeural（女）
es-ES-LaiaNeural（女）
es-ES-LiaNeural（女）
es-ES-NilNeural（男）
es-ES-SaulNeural（男）
es-ES-TeoNeural（男）
es-ES-TrianaNeural（女）
es-ES-VeraNeural（女）
es-ES-XimenaNeural（女）
es-GQ	西班牙语（赤道几内亚）	es-GQ-TeresaNeural（女）
es-GQ-JavierNeural（男）
es-GT	西班牙语（危地马拉）	es-GT-MartaNeural（女）
es-GT-AndresNeural（男）
es-HN	西班牙语（洪都拉斯）	es-HN-KarlaNeural（女）
es-HN-CarlosNeural（男）
es-MX	西班牙语(墨西哥)	es-MX-DaliaNeural（女）
es-MX-JorgeNeural（男）
es-MX-BeatrizNeural（女）
es-MX-CandelaNeural（女）
es-MX-CarlotaNeural（女）
es-MX-CecilioNeural（男）
es-MX-GerardoNeural（男）
es-MX-LarissaNeural（女）
es-MX-LibertoNeural（男）
es-MX-LucianoNeural（男）
es-MX-MarinaNeural（女）
es-MX-NuriaNeural（女）
es-MX-PelayoNeural（男）
es-MX-RenataNeural（女）
es-MX-YagoNeural（男）
es-NI	西班牙（尼加拉瓜）	es-NI-YolandaNeural（女）
es-NI-FedericoNeural（男）
es-PA	西班牙语（巴拿马）	es-PA-MargaritaNeural（女）
es-PA-RobertoNeural（男）
es-PE	西班牙语（秘鲁）	es-PE-CamilaNeural（女）
es-PE-AlexNeural（男）
es-PR	西班牙语（波多黎各）	es-PR-KarinaNeural（女）
es-PR-VictorNeural（男）
es-PY	西班牙语（巴拉圭）	es-PY-TaniaNeural（女）
es-PY-MarioNeural（男）
es-SV	西班牙语（萨尔瓦多）	es-SV-LorenaNeural（女）
es-SV-RodrigoNeural（男）
es-US	西班牙语（美国）	es-US-PalomaNeural（女）
es-US-AlonsoNeural（男）
es-UY	西班牙语（乌拉圭）	es-UY-ValentinaNeural（女）
es-UY-MateoNeural（男）
es-VE	西班牙语（委内瑞拉）	es-VE-PaolaNeural（女）
es-VE-SebastianNeural（男）
et-EE	爱沙尼亚语(爱沙尼亚)	et-EE-AnuNeural3（女）
et-EE-KertNeural3（男）
eu-ES	巴斯克语	eu-ES-AinhoaNeural3（女）
eu-ES-AnderNeural3（男）
fa-IR	波斯语（伊朗）	fa-IR-DilaraNeural3（女）
fa-IR-FaridNeural3（男）
fi-FI	芬兰语（芬兰）	fi-FI-SelmaNeural（女）
fi-FI-HarriNeural（男）
fi-FI-NooraNeural（女）
fil-PH	菲律宾语（菲律宾）	fil-PH-BlessicaNeural3（女）
fil-PH-AngeloNeural3（男）
fr-BE	法语（比利时）	fr-BE-CharlineNeural（女）
fr-BE-GerardNeural（男）
fr-CA	法语（加拿大）	fr-CA-SylvieNeural（女）
fr-CA-JeanNeural（男）
fr-CA-AntoineNeural（男）
fr-CA-ThierryNeural（男）
fr-CH	法语（瑞士）	fr-CH-ArianeNeural（女）
fr-CH-FabriceNeural（男）
fr-FR	法语（法国）	fr-FR-DeniseNeural（女）
fr-FR-HenriNeural（男）
fr-FR-VivienneMultilingualNeural4（女）
fr-FR-RemyMultilingualNeural4（男）
fr-FR-LucienMultilingualNeural4（男）
fr-FR-AlainNeural（男）
fr-FR-BrigitteNeural（女）
fr-FR-CelesteNeural（女）
fr-FR-ClaudeNeural（男）
fr-FR-CoralieNeural（女）
fr-FR-EloiseNeural（女性、儿童）
fr-FR-JacquelineNeural（女）
fr-FR-JeromeNeural（男）
fr-FR-JosephineNeural（女）
fr-FR-MauriceNeural（男）
fr-FR-YvesNeural（男）
fr-FR-YvetteNeural（女）
ga-IE	爱尔兰语（爱尔兰）	ga-IE-OrlaNeural3（女）
ga-IE-ColmNeural3（男）
gl-ES	加利西亚语	gl-ES-SabelaNeural3（女）
gl-ES-RoiNeural3（男）
gu-IN	古吉拉特语（印度）	gu-IN-DhwaniNeural（女）
gu-IN-NiranjanNeural（男）
he-IL	希伯来语（以色列）	he-IL-HilaNeural（女）
he-IL-AvriNeural（男）
hi-IN	印地语（印度）	hi-IN-AaravNeural（男）
hi-IN-AnanyaNeural（女）
hi-IN-KavyaNeural（女）
hi-IN-KunalNeural（男）
hi-IN-RehaanNeural（男）
hi-IN-SwaraNeural（女）
hi-IN-MadhurNeural（男）
hi-IN-AartiNeural1（女）
hi-IN-ArjunNeural1（男）
hr-HR	克罗地亚语（克罗地亚）	hr-HR-GabrijelaNeural（女）
hr-HR-SreckoNeural（男）
hu-HU	匈牙利语(匈牙利)	hu-HU-NoemiNeural（女）
hu-HU-TamasNeural（男）
hy-AM	亚美尼亚语（亚美尼亚）	hy-AM-AnahitNeural3（女）
hy-AM-HaykNeural3（男）
id-ID	印度尼西亚语(印度尼西亚)	id-ID-GadisNeural（女）
id-ID-ArdiNeural（男）
is-IS	冰岛语(冰岛)	is-IS-GudrunNeural3（女）
is-IS-GunnarNeural3（男）
it-IT	意大利语（意大利）	it-IT-ElsaNeural（女）
it-IT-IsabellaNeural（女）
it-IT-DiegoNeural（男）
it-IT-AlessioMultilingualNeural4（男）
it-IT-IsabellaMultilingualNeural4（女）
it-IT-GiuseppeMultilingualNeural4（男）
it-IT-MarcelloMultilingualNeural4（男）
it-IT-BenignoNeural（男）
it-IT-CalimeroNeural（男）
it-IT-CataldoNeural（男）
it-IT-FabiolaNeural（女）
it-IT-FiammaNeural（女）
it-IT-GianniNeural（男）
it-IT-GiuseppeNeural（男）
it-IT-ImeldaNeural（女）
it-IT-IrmaNeural（女）
it-IT-LisandroNeural（男）
it-IT-PalmiraNeural（女）
it-IT-PierinaNeural（女）
it-IT-RinaldoNeural（男）
iu-CANS-CA	因纽特语(音节，加拿大)	iu-Cans-CA-SiqiniqNeural3（女）
iu-Cans-CA-TaqqiqNeural3（男）
iu-LATN-CA	因纽特语(拉丁语、加拿大)	iu-Latn-CA-SiqiniqNeural3（女）
iu-Latn-CA-TaqqiqNeural3（男）
ja-JP	日语（日本）	ja-JP-NanamiNeural（女）
ja-JP-KeitaNeural（男）
ja-JP-AoiNeural（女）
ja-JP-DaichiNeural（男）
ja-JP-MayuNeural（女）
ja-JP-NaokiNeural（男）
ja-JP-ShioriNeural（女）
ja-JP-MasaruMultilingualNeural1,4（男）
ja-JP-Masaru:DragonHDLatestNeural1（男）
jv-ID	爪哇语(拉丁语、印度尼西亚)	jv-ID-SitiNeural3（女）
jv-ID-DimasNeural3（男）
ka-GE	格鲁吉亚语（格鲁吉亚）	ka-GE-EkaNeural3（女）
ka-GE-GiorgiNeural3（男）
kk-KZ	哈萨克语（哈萨克斯坦）	kk-KZ-AigulNeural3（女）
kk-KZ-DauletNeural3（男）
km-KH	高棉语(柬埔寨)	km-KH-SreymomNeural3（女）
km-KH-PisethNeural3（男）
kn-IN	卡纳达语（印度）	kn-IN-SapnaNeural3（女）
kn-IN-GaganNeural3（男）
ko-KR	韩语(韩国)	ko-KR-SunHiNeural（女）
ko-KR-InJoonNeural（男）
ko-KR-HyunsuMultilingualNeural4（男）
ko-KR-BongJinNeural（男）
ko-KR-GookMinNeural（男）
ko-KR-HyunsuNeural（男）
ko-KR-JiMinNeural（女）
ko-KR-SeoHyeonNeural（女）
ko-KR-SoonBokNeural（女）
ko-KR-YuJinNeural（女）
lo-LA	老挝语(老挝)	lo-LA-KeomanyNeural3（女）
lo-LA-ChanthavongNeural3（男）
lt-LT	立陶宛语(立陶宛)	lt-LT-OnaNeural3（女）
lt-LT-LeonasNeural3（男）
lv-LV	拉脱维亚语(拉脱维亚)	lv-LV-EveritaNeural3（女）
lv-LV-NilsNeural3（男）
mk-MK	马其顿语（北马其顿）	mk-MK-MarijaNeural3（女）
mk-MK-AleksandarNeural3（男）
ml-IN	马拉雅拉姆语（印度）	ml-IN-SobhanaNeural3（女）
ml-IN-MidhunNeural3（男）
mn-MN	蒙古语（蒙古）	mn-MN-YesuiNeural3（女）
mn-MN-BataaNeural3（男）
mr-IN	马拉地语（印度）	mr-IN-AarohiNeural（女）
mr-IN-ManoharNeural（男）
ms-MY	马来语（马来西亚）	ms-MY-YasminNeural（女）
ms-MY-OsmanNeural（男）
mt-MT	马耳他语（马耳他）	mt-MT-GraceNeural3（女）
mt-MT-JosephNeural3（男）
my-MM	缅甸语(缅甸)	my-MM-NilarNeural3（女）
my-MM-ThihaNeural3（男）
nb-NO	书面挪威语（挪威）	nb-NO-PernilleNeural（女）
nb-NO-FinnNeural（男）
nb-NO-IselinNeural（女）
ne-NP	尼泊尔语（尼泊尔）	ne-NP-HemkalaNeural3（女）
ne-NP-SagarNeural3（男）
nl-BE	荷兰语（比利时）	nl-BE-DenaNeural（女）
nl-BE-ArnaudNeural（男）
nl-NL	荷兰语（荷兰）	nl-NL-FennaNeural（女）
nl-NL-MaartenNeural（男）
nl-NL-ColetteNeural（女）
or-IN	奥里亚语（印度）	or-IN-SubhasiniNeural3（女）
or-IN-SukantNeural3（男）
pa-IN	旁遮普语（印度）	pa-IN-OjasNeural3（男）
pa-IN-VaaniNeural3（女）
pl-PL	波兰语（波兰）	pl-PL-AgnieszkaNeural（女）
pl-PL-MarekNeural（男）
pl-PL-ZofiaNeural（女）
ps-AF	普什图语（阿富汗）	ps-AF-LatifaNeural3（女）
ps-AF-GulNawazNeural3（男）
pt-BR	葡萄牙语（巴西）	pt-BR-FranciscaNeural（女）
pt-BR-AntonioNeural（男）
pt-BR-MacerioMultilingualNeural4（男）
pt-BR-ThalitaMultilingualNeural4（女）
pt-BR-BrendaNeural（女）
pt-BR-DonatoNeural（男）
pt-BR-ElzaNeural（女）
pt-BR-FabioNeural（男）
pt-BR-GiovannaNeural（女）
pt-BR-HumbertoNeural（男）
pt-BR-JulioNeural（男）
pt-BR-LeilaNeural（女）
pt-BR-LeticiaNeural（女）
pt-BR-ManuelaNeural（女）
pt-BR-NicolauNeural（男）
pt-BR-ThalitaNeural（女）
pt-BR-ValerioNeural（男）
pt-BR-YaraNeural（女）
pt-PT	葡萄牙语(葡萄牙)	pt-PT-RaquelNeural（女）
pt-PT-DuarteNeural（男）
pt-PT-FernandaNeural（女）
ro-RO	罗马尼亚语(罗马尼亚)	ro-RO-AlinaNeural（女）
ro-RO-EmilNeural（男）
ru-RU	俄语（俄罗斯）	ru-RU-SvetlanaNeural（女）
ru-RU-DmitryNeural（男）
ru-RU-DariyaNeural（女）
si-LK	僧伽罗语(斯里兰卡)	si-LK-ThiliniNeural3（女）
si-LK-SameeraNeural3（男）
sk-SK	斯洛伐克语（斯洛伐克）	sk-SK-ViktoriaNeural（女）
sk-SK-LukasNeural（男）
sl-SI	斯洛文尼亚语（斯洛文尼亚）	sl-SI-PetraNeural（女）
sl-SI-RokNeural（男）
so-SO	索马里语（索马里）	so-SO-UbaxNeural3（女）
so-SO-MuuseNeural3（男）
sq-AL	阿尔巴尼亚语（阿尔巴尼亚）	sq-AL-AnilaNeural3（女）
sq-AL-IlirNeural3（男）
sr-LATN-RS	塞尔维亚语(拉丁语，塞尔维亚共和国)	sr-Latn-RS-NicholasNeural3（男）
sr-Latn-RS-SophieNeural3（女）
sr-RS	塞尔维亚语(西里尔文，塞尔维亚)	sr-RS-SophieNeural3（女）
sr-RS-NicholasNeural3（男）
su-ID	巽他语（印度尼西亚）	su-ID-TutiNeural3（女）
su-ID-JajangNeural3（男）
sv-SE	瑞典语（瑞典）	sv-SE-SofieNeural（女）
sv-SE-MattiasNeural（男）
sv-SE-HilleviNeural（女）
sw-KE	斯瓦希里语(肯尼亚)	sw-KE-ZuriNeural3（女）
sw-KE-RafikiNeural3（男）
sw-TZ	斯瓦希里语（坦桑尼亚）	sw-TZ-RehemaNeural（女）
sw-TZ-DaudiNeural（男）
ta-IN	泰米尔语（印度）	ta-IN-PallaviNeural（女）
ta-IN-ValluvarNeural（男）
ta-LK	泰米尔语（斯里兰卡）	ta-LK-SaranyaNeural（女）
ta-LK-KumarNeural（男）
ta-MY	泰米尔语（马来西亚）	ta-MY-KaniNeural（女）
ta-MY-SuryaNeural（男）
ta-SG	泰米尔语（新加坡）	ta-SG-VenbaNeural（女）
ta-SG-AnbuNeural（男）
te-IN	泰卢固语（印度）	te-IN-ShrutiNeural（女）
te-IN-MohanNeural（男）
th-TH	泰语（泰国）	th-TH-PremwadeeNeural（女）
th-TH-NiwatNeural（男）
th-TH-AcharaNeural（女）
tr-TR	土耳其语 (Türkiye)	tr-TR-EmelNeural（女）
tr-TR-AhmetNeural（男）
uk-UA	乌克兰语(乌克兰)	uk-UA-PolinaNeural（女）
uk-UA-OstapNeural（男）
ur-IN	乌尔都语（印度）	ur-IN-GulNeural（女）
ur-IN-SalmanNeural（男）
ur-PK	乌尔都语（巴基斯坦）	ur-PK-UzmaNeural（女）
ur-PK-AsadNeural（男）
uz-UZ	乌兹别克语(拉丁语，乌兹别克斯坦)	uz-UZ-MadinaNeural3（女）
uz-UZ-SardorNeural3（男）
vi-VN	越南语(越南)	vi-VN-HoaiMyNeural（女）
vi-VN-NamMinhNeural（男）
wuu-CN	中文（吴语，简体）	wuu-CN-XiaotongNeural3（女）
wuu-CN-YunzheNeural3（男）
yue-CN	中文（粤语，简体）	yue-CN-XiaoMinNeural3（女）
yue-CN-YunSongNeural3（男）
zh-CN	中文（普通话，简体）	zh-CN-XiaoxiaoNeural（女）
zh-CN-YunxiNeural（男）
zh-CN-YunjianNeural（男）
zh-CN-XiaoyiNeural（女）
zh-CN-YunyangNeural（男）
zh-CN-XiaochenNeural（女）
zh-CN-XiaochenMultilingualNeural4（女）
zh-CN-XiaohanNeural（女）
zh-CN-XiaomengNeural（女）
zh-CN-XiaomoNeural（女）
zh-CN-XiaoqiuNeural（女）
zh-CN-XiaorouNeural（女）
zh-CN-XiaoruiNeural（女）
zh-CN-XiaoshuangNeural（女性、儿童）
zh-CN-XiaoxiaoDialectsNeural6（女）
zh-CN-XiaoxiaoMultilingualNeural4（女）
zh-CN-XiaoyanNeural（女）
zh-CN-XiaoyouNeural（女性、儿童）
zh-CN-XiaoyuMultilingualNeural4（女）
zh-CN-XiaozhenNeural（女）
zh-CN-YunfengNeural（男）
zh-CN-YunhaoNeural（男）
zh-CN-YunjieNeural（男）
zh-CN-YunxiaNeural（男）
zh-CN-YunyeNeural（男）
zh-CN-YunyiMultilingualNeural4（男）
zh-CN-YunzeNeural（男）
zh-CN-YunfanMultilingualNeural1,4（男）
zh-CN-YunxiaoMultilingualNeural1,4（男）
zh-CN-Xiaochen:DragonHDLatestNeural1（女）
zh-CN-GUANGXI	中文（广西口音普通话，简体）	zh-CN-guangxi-YunqiNeural1,3（男）
zh-CN-henan	中文（中原官话河南，简体）	zh-CN-henan-YundengNeural3（男）
zh-CN-liaoning	中文（东北官话，简体）	zh-CN-liaoning-XiaobeiNeural1,3（女）
zh-CN-liaoning-YunbiaoNeural1,3（男）
zh-CN-shaanxi	中文（中原官话陕西，简体）	zh-CN-shaanxi-XiaoniNeural1,3（女）
zh-CN-shandong	中文（冀鲁官话，简体）	zh-CN-shandong-YunxiangNeural3（男）
zh-CN-sichuan	中文（西南普通话，简体）	zh-CN-sichuan-YunxiNeural1,3（男）
zh-HK	中文(粤语，繁体)	zh-HK-HiuMaanNeural（女）
zh-HK-WanLungNeural（男）
zh-HK-HiuGaaiNeural（女）
zh-TW	中文（台湾普通话，繁体）	zh-TW-HsiaoChenNeural（女）
zh-TW-YunJheNeural（男）
zh-TW-HsiaoYuNeural（女）
zu-ZA	祖鲁语(南非)	zu-ZA-ThandoNeural3（女）
zu-ZA-ThembaNeural3（男）

'''

whisper_voice_mapping = {
    'af': 'af-ZA-AdriNeural3',
    'am': 'am-ET-MekdesNeural3',
    'ar': 'ar-SA-ZariyahNeural',
    'as': 'as-IN-YashicaNeural3',
    'az': 'az-AZ-BanuNeural3',
    'bg': 'bg-BG-KalinaNeural',
    'bn': 'bn-IN-TanishaaNeural3',
    'bs': 'bs-BA-VesnaNeural3',
    'ca': 'ca-ES-JoanaNeural',
    'cs': 'cs-CZ-VlastaNeural',
    'cy': 'cy-GB-NiaNeural3',
    'da': 'da-DK-ChristelNeural',
    'de': 'de-DE-KatjaNeural',
    'el': 'el-GR-AthinaNeural',
    'en': 'en-US-JennyNeural',
    'es': 'es-ES-ElviraNeural',
    'et': 'et-EE-AnuNeural3',
    'eu': 'eu-ES-AinhoaNeural3',
    'fa': 'fa-IR-DilaraNeural3',
    'fi': 'fi-FI-SelmaNeural',
    'fr': 'fr-FR-DeniseNeural',
    'gl': 'gl-ES-SabelaNeural3',
    'gu': 'gu-IN-DhwaniNeural',
    'he': 'he-IL-HilaNeural',
    'hi': 'hi-IN-AnanyaNeural',
    'hr': 'hr-HR-GabrijelaNeural',
    'hu': 'hu-HU-NoemiNeural',
    'hy': 'hy-AM-AnahitNeural3',
    'id': 'id-ID-GadisNeural',
    'is': 'is-IS-GudrunNeural3',
    'it': 'it-IT-ElsaNeural',
    'ja': 'ja-JP-NanamiNeural',
    'ka': 'ka-GE-EkaNeural3',
    'kn': 'kn-IN-SapnaNeural3',
    'ko': 'ko-KR-SunHiNeural',
    'lt': 'lt-LT-OnaNeural3',
    'lv': 'lv-LV-EveritaNeural3',
    'mk': 'mk-MK-MarijaNeural3',
    'ml': 'ml-IN-SobhanaNeural3',
    'mr': 'mr-IN-AarohiNeural',
    'ms': 'ms-MY-YasminNeural',
    'mt': 'mt-MT-GraceNeural3',
    'my': 'my-MM-NilarNeural3',
    'ne': 'ne-NP-HemkalaNeural3',
    'nl': 'nl-NL-FennaNeural',
    'pa': 'pa-IN-VaaniNeural3',
    'pl': 'pl-PL-AgnieszkaNeural',
    'ps': 'ps-AF-LatifaNeural3',
    'pt': 'pt-PT-RaquelNeural',
    'ro': 'ro-RO-AlinaNeural',
    'ru': 'ru-RU-SvetlanaNeural',
    'si': 'si-LK-ThiliniNeural3',
    'sk': 'sk-SK-ViktoriaNeural',
    'sl': 'sl-SI-PetraNeural',
    'so': 'so-SO-UbaxNeural3',
    'sq': 'sq-AL-AnilaNeural3',
    'sr': 'sr-Latn-RS-SophieNeural3',
    'su': 'su-ID-TutiNeural3',
    'sv': 'sv-SE-SofieNeural',
    'sw': 'sw-KE-ZuriNeural3',
    'ta': 'ta-IN-PallaviNeural',
    'te': 'te-IN-ShrutiNeural',
    'th': 'th-TH-PremwadeeNeural',
    'tr': 'tr-TR-EmelNeural',
    'uk': 'uk-UA-PolinaNeural',
    'ur': 'ur-PK-UzmaNeural',
    'vi': 'vi-VN-HoaiMyNeural',
    'yue': 'yue-CN-XiaoMinNeural3',
    'zh': 'zh-CN-XiaoxiaoNeural',
    'zt': 'zh-TW-HsiaoChenNeural'
}

libretranslate_voice_mapping = {
    'ar': 'ar-SA-ZariyahNeural',
    'az': 'az-AZ-BanuNeural3',
    'bg': 'bg-BG-KalinaNeural',
    'bn': 'bn-IN-TanishaaNeural3',
    'ca': 'ca-ES-JoanaNeural',
    'cs': 'cs-CZ-VlastaNeural',
    'da': 'da-DK-ChristelNeural',
    'de': 'de-DE-KatjaNeural',
    'el': 'el-GR-AthinaNeural',
    'en': 'en-US-JennyNeural',
    'es': 'es-ES-ElviraNeural',
    'et': 'et-EE-AnuNeural3',
    'eu': 'eu-ES-AinhoaNeural3',
    'fa': 'fa-IR-DilaraNeural3',
    'fi': 'fi-FI-SelmaNeural',
    'fr': 'fr-FR-DeniseNeural',
    'ga': 'ga-IE-OrlaNeural3',
    'gl': 'gl-ES-SabelaNeural3',
    'he': 'he-IL-HilaNeural',
    'hi': 'hi-IN-AnanyaNeural',
    'hu': 'hu-HU-NoemiNeural',
    'id': 'id-ID-GadisNeural',
    'it': 'it-IT-ElsaNeural',
    'ja': 'ja-JP-NanamiNeural',
    'ko': 'ko-KR-SunHiNeural',
    'lt': 'lt-LT-OnaNeural3',
    'lv': 'lv-LV-EveritaNeural3',
    'ms': 'ms-MY-YasminNeural',
    'nl': 'nl-NL-FennaNeural',
    'pl': 'pl-PL-AgnieszkaNeural',
    'pt': 'pt-PT-RaquelNeural',
    'ro': 'ro-RO-AlinaNeural',
    'ru': 'ru-RU-SvetlanaNeural',
    'sk': 'sk-SK-ViktoriaNeural',
    'sl': 'sl-SI-PetraNeural',
    'sq': 'sq-AL-AnilaNeural3',
    'sr': 'sr-Latn-RS-SophieNeural3',
    'sv': 'sv-SE-SofieNeural',
    'th': 'th-TH-PremwadeeNeural',
    'tl': 'fil-PH-BlessicaNeural3',
    'tr': 'tr-TR-EmelNeural',
    'uk': 'uk-UA-PolinaNeural',
    'ur': 'ur-PK-UzmaNeural',
    'vi': 'vi-VN-HoaiMyNeural',
    'zh': 'zh-CN-XiaoxiaoNeural',
    'zt': 'yue-CN-YunSongNeural',
    'wuu': 'zh-CN-YunzeNeural'
}

import requests
import pyaudio
import miniaudio
class TTSHandler:
    def __init__(self,logger,config,mode,header,outputList):
        self.baseurl=config.get('baseurl')
        self.sourceType='whisper'if mode!='mic' else'libre'
        self.header=header
        self.logger=logger
        if config.get("TTSOutputName")== "" or config.get("TTSOutputName") is None or config.get("TTSOutputName")== "default":
            logger.put({"text":"使用系统默认输出","level":"info"})
            self.deviceindex=None
        else:
            try:
                self.deviceindex=outputList.index(config.get("TTSOutputName"))
            except ValueError:
                logger.put({"text":"无法找到指定输出，使用系统默认麦克风","level":"info"})
                self.deviceindex=None
    def tts_audio(self,text,language='zh'):

        self.logger.put({"text":f"{self.baseurl}/func/tts","level":"debug"})

        response = requests.post(
            self.baseurl+'/func/tts',
            json={
                "input": text,
                "voice": libretranslate_voice_mapping[language] if self.sourceType=='libre' else whisper_voice_mapping[language],
                "speed": 1.2
            },
            headers=self.header,
            stream=True
        )
        

        if response.status_code != 200:
            if response.status_code == 430:
                res=response.json()
                self.logger.put({"text":f"请求过于频繁,触发规则{res.get("limit")}","level":"warning"})
            else:    
                self.logger.put({"text":f"数据接收异常:{response.text}","level":"warning"})
            return
        self.logger.put({"text":f"TTS文本生成: ","level":"debug"})
        # 直接将响应内容收集到字节对象
        mp3_bytes = b''.join(response.iter_content(chunk_size=8192))

        # 自动检测格式并解码（无需文件信息）
        decoded = miniaudio.decode(
            mp3_bytes,
            output_format=miniaudio.SampleFormat.SIGNED16
        )

        # 转换为 bytes 类型
        pcm_bytes = decoded.samples.tobytes()

        # 初始化 PyAudio
        p = pyaudio.PyAudio()
        stream = p.open(
            format=pyaudio.paInt16,
            channels=decoded.nchannels,
            rate=decoded.sample_rate,
            output=True,
            output_device_index=self.deviceindex
        )

        # 分块播放（确保块大小是帧的整数倍）
        frame_size = decoded.nchannels * decoded.sample_width  # 每帧字节数
        chunk_size = 4096 * frame_size  # 动态计算块大小sa
        for i in range(0, len(pcm_bytes), chunk_size):
            stream.write(pcm_bytes[i:i+chunk_size])

        # 清理资源
        stream.stop_stream()
        stream.close()
        p.terminate()

